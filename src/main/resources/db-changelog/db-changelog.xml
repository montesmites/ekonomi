<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">
  <changeSet author="2023-05-06 (generated)" id="1683376900684-1">
    <preConditions onFail="MARK_RAN">
      <not>
        <tableExists tableName="bokfaar"/>
      </not>
    </preConditions>
    <createTable tableName="bokfaar">
      <column name="aar_id" type="VARCHAR(255)">
        <constraints nullable="false" primaryKey="true" primaryKeyName="bokfaar_pkey"/>
      </column>
      <column name="boerjan" type="date"/>
      <column name="slut" type="date"/>
    </createTable>
    <createTable tableName="konto">
      <column name="aar_id" type="VARCHAR(255)">
        <constraints nullable="false" primaryKey="true" primaryKeyName="konto_pkey"/>
      </column>
      <column name="konto" type="VARCHAR(255)">
        <constraints nullable="false" primaryKey="true" primaryKeyName="konto_pkey"/>
      </column>
      <column name="txt" type="VARCHAR(255)"/>
      <column name="ej_aktivt" type="BOOLEAN"/>
    </createTable>
    <createTable tableName="reing">
      <column name="id" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="reing_pkey"/>
      </column>
      <column name="aar_id" type="VARCHAR(255)"/>
      <column name="ing_bal" type="BIGINT"/>
      <column name="konto" type="VARCHAR(255)"/>
    </createTable>
    <createTable tableName="ver">
      <column name="aar_id" type="VARCHAR(255)">
        <constraints nullable="false" primaryKey="true" primaryKeyName="ver_pkey"/>
      </column>
      <column name="ver_nr" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="ver_pkey"/>
      </column>
      <column name="ver_serie" type="VARCHAR(255)">
        <constraints nullable="false" primaryKey="true" primaryKeyName="ver_pkey"/>
      </column>
      <column name="txt" type="VARCHAR(255)"/>
      <column name="rdatum" type="date"/>
      <column name="tdatum" type="date"/>
    </createTable>
    <createTable tableName="verrad">
      <column name="aar_id" type="VARCHAR(255)">
        <constraints nullable="false" primaryKey="true" primaryKeyName="verrad_pkey"/>
      </column>
      <column name="rad" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="verrad_pkey"/>
      </column>
      <column name="ver_nr" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="verrad_pkey"/>
      </column>
      <column name="ver_serie" type="VARCHAR(255)">
        <constraints nullable="false" primaryKey="true" primaryKeyName="verrad_pkey"/>
      </column>
      <column name="belopp" type="BIGINT"/>
      <column name="definitiv" type="BOOLEAN"/>
      <column name="konto" type="VARCHAR(255)"/>
      <column name="struken" type="BOOLEAN"/>
      <column name="tillagd" type="BOOLEAN"/>
    </createTable>
  </changeSet>
  <changeSet id="migrate-legacy-db-schema" author="migrate-legacy-db-schema">
    <createSequence sequenceName="fiscal_year_seq"/>
    <createSequence sequenceName="account_seq"/>
    <createSequence sequenceName="balance_seq"/>
    <createSequence sequenceName="event_seq"/>
    <createSequence sequenceName="entry_seq"/>
    <createTable tableName="fiscal_year">
      <column name="fiscal_year_id" type="bigint">
        <constraints primaryKey="true"/>
      </column>
      <column name="fiscal_calendar_year" type="int">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="account">
      <column name="account_id" type="bigint">
        <constraints primaryKey="true"/>
      </column>
      <column name="fiscal_year_id" type="bigint">
        <constraints nullable="false"/>
      </column>
      <column name="qualifier" type="varchar">
        <constraints nullable="false"/>
      </column>
      <column name="name" type="varchar">
        <constraints nullable="false"/>
      </column>
      <column name="active" type="boolean">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="balance">
      <column name="balance_id" type="bigint">
        <constraints primaryKey="true"/>
      </column>
      <column name="account_id" type="bigint">
        <constraints nullable="false"/>
      </column>
      <column name="balance" type="numeric(20,2)">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="event">
      <column name="event_id" type="bigint">
        <constraints primaryKey="true"/>
      </column>
      <column name="fiscal_year_id" type="bigint">
        <constraints nullable="false"/>
      </column>
      <column name="event_date" type="date">
        <constraints nullable="false"/>
      </column>
      <column name="description" type="varchar">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="entry">
      <column name="entry_id" type="bigint">
        <constraints primaryKey="true"/>
      </column>
      <column name="event_id" type="bigint">
        <constraints nullable="false"/>
      </column>
      <column name="account_id" type="bigint">
        <constraints nullable="false"/>
      </column>
      <column name="amount" type="numeric(20,2)">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <addForeignKeyConstraint baseTableName="account" baseColumnNames="fiscal_year_id"
      constraintName="account_fiscal_year_id"
      referencedTableName="fiscal_year" referencedColumnNames="fiscal_year_id"/>
    <addForeignKeyConstraint baseTableName="balance" baseColumnNames="account_id"
      constraintName="balance_account_id"
      referencedTableName="account" referencedColumnNames="account_id"/>
    <addForeignKeyConstraint baseTableName="event" baseColumnNames="fiscal_year_id"
      constraintName="event_fiscal_year_id"
      referencedTableName="fiscal_year" referencedColumnNames="fiscal_year_id"/>
    <addForeignKeyConstraint baseTableName="entry" baseColumnNames="event_id"
      constraintName="entry_event_id"
      referencedTableName="event" referencedColumnNames="event_id"/>
    <addForeignKeyConstraint baseTableName="entry" baseColumnNames="account_id"
      constraintName="entry_account_id"
      referencedTableName="account" referencedColumnNames="account_id"/>
  </changeSet>
</databaseChangeLog>
